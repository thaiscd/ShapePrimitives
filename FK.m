function [P] = FK(r, t, origin)

% INPUTS:
% R -> 1x4 vector [r1 r2 r3 r4]
% T -> 1xnact vector containing joint angles [t1, t2, ...]
% ORIGIN -> 1x2 vector containing the origin of the manipulator

% OUTPUTS:
% P -> 5x2 or 4x2 matrix containing the points of the manipulator

a = [0 0 0 0];
x0 = origin(1);
y0 = origin(2);

nact = length(t);

if nact == 2
    A1 = [cos(t(1)), -sin(t(1))*cos(a(1)), sin(t(1))*sin(a(1)), r(1)*cos(t(1));...
            sin(t(1)), cos(t(1))*cos(a(1)), -cos(t(1))*sin(a(1)), r(1)*sin(t(1));...
            0, sin(a(1)), cos(a(1)), 0;...
            0, 0, 0, 1];
    A2 = [cos(t(2)), -sin(t(2))*cos(a(2)), sin(t(2))*sin(a(2)), r(2)*cos(t(2));...
            sin(t(2)), cos(t(2))*cos(a(2)), -cos(t(2))*sin(a(2)), r(2)*sin(t(2));...
            0, sin(a(2)), cos(a(2)), 0;...
            0, 0, 0, 1];

    T1 = A1*A2;

    P = zeros(3,2);
    P(1,:) = origin;
    P(2,:) = [x0 + A1(1,4), y0 + A1(2,4)];
    P(3,:) = [x0 + T1(1,4), y0 + T1(2,4)];

elseif nact == 3

    A1 = [cos(t(1)), -sin(t(1))*cos(a(1)), sin(t(1))*sin(a(1)), r(1)*cos(t(1));...
            sin(t(1)), cos(t(1))*cos(a(1)), -cos(t(1))*sin(a(1)), r(1)*sin(t(1));...
            0, sin(a(1)), cos(a(1)), 0;...
            0, 0, 0, 1];
    A2 = [cos(t(2)), -sin(t(2))*cos(a(2)), sin(t(2))*sin(a(2)), r(2)*cos(t(2));...
            sin(t(2)), cos(t(2))*cos(a(2)), -cos(t(2))*sin(a(2)), r(2)*sin(t(2));...
            0, sin(a(2)), cos(a(2)), 0;...
            0, 0, 0, 1];
    A3 = [cos(t(3)), -sin(t(3))*cos(a(3)), sin(t(3))*sin(a(3)), r(3)*cos(t(3));...
            sin(t(3)), cos(t(3))*cos(a(3)), -cos(t(3))*sin(a(3)), r(3)*sin(t(3));...
            0, sin(a(3)), cos(a(3)), 0;...
            0, 0, 0, 1];
    % A4 = [cos(t(4)), -sin(t(4))*cos(a(4)), sin(t(4))*sin(a(4)), r(4)*cos(t(4));...
    %         sin(t(4)), cos(t(4))*cos(a(4)), -cos(t(4))*sin(a(4)), r(4)*sin(t(4));...
    %         0, sin(a(4)), cos(a(4)), 0;...
    %         0, 0, 0, 1];

    T1 = A1*A2;
    T2 = T1*A3;
    % T3 = T2*A4;

    P = zeros(4,2);
    P(1,:) = origin;
    P(2,:) = [x0 + A1(1,4), y0 + A1(2,4)];
    P(3,:) = [x0 + T1(1,4), y0 + T1(2,4)];
    P(4,:) = [x0 + T2(1,4), y0 + T2(2,4)];
    % P(5,:) = [x0 + T3(1,4), y0 + T3(2,4)];
    
else
    
    A1 = [cos(t(1)), -sin(t(1))*cos(a(1)), sin(t(1))*sin(a(1)), r(1)*cos(t(1));...
        sin(t(1)), cos(t(1))*cos(a(1)), -cos(t(1))*sin(a(1)), r(1)*sin(t(1));...
        0, sin(a(1)), cos(a(1)), 0;...
        0, 0, 0, 1];
    A2 = [cos(t(2)), -sin(t(2))*cos(a(2)), sin(t(2))*sin(a(2)), r(2)*cos(t(2));...
            sin(t(2)), cos(t(2))*cos(a(2)), -cos(t(2))*sin(a(2)), r(2)*sin(t(2));...
            0, sin(a(2)), cos(a(2)), 0;...
            0, 0, 0, 1];
    A3 = [cos(t(3)), -sin(t(3))*cos(a(3)), sin(t(3))*sin(a(3)), r(3)*cos(t(3));...
            sin(t(3)), cos(t(3))*cos(a(3)), -cos(t(3))*sin(a(3)), r(3)*sin(t(3));...
            0, sin(a(3)), cos(a(3)), 0;...
            0, 0, 0, 1];
    A4 = [cos(t(4)), -sin(t(4))*cos(a(4)), sin(t(4))*sin(a(4)), r(4)*cos(t(4));...
            sin(t(4)), cos(t(4))*cos(a(4)), -cos(t(4))*sin(a(4)), r(4)*sin(t(4));...
            0, sin(a(4)), cos(a(4)), 0;...
            0, 0, 0, 1];

    T1 = A1*A2;
    T2 = T1*A3;
    T3 = T2*A4;

    P = zeros(5,2);
    P(1,:) = origin;
    P(2,:) = [x0 + A1(1,4), y0 + A1(2,4)];
    P(3,:) = [x0 + T1(1,4), y0 + T1(2,4)];
    P(4,:) = [x0 + T2(1,4), y0 + T2(2,4)];
    P(5,:) = [x0 + T3(1,4), y0 + T3(2,4)];
    
    
end

end
